{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/home/amanda-kenzie/Documents/Faculdade/TCC/mobile/app-react-native-report/src/pages/MyReports/index.tsx\";\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (it) return (it = it.call(o)).next.bind(it); if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from \"react\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Animated from \"react-native-web/dist/exports/Animated\";\nimport { useNavigation } from \"@react-navigation/core\";\nimport { RectButton } from \"react-native-gesture-handler\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport styles from \"./styles\";\nimport { Feather } from \"@expo/vector-icons\";\nimport Swipeable from \"react-native-gesture-handler/Swipeable\";\nimport { ReportCard } from \"../../components/ReportCard\";\nimport { Header } from \"../../components/Header\";\nimport { BackArrowButton } from \"../../components/Buttons/BackArrowButton\";\nimport { api } from \"../../services/api\";\nimport { useAuth } from \"../../hooks/auth\";\nimport colors from \"../../styles/colors\";\nimport { update } from \"../../services/database/storage\";\nexport function MyReports() {\n  var _this = this;\n\n  var _useAuth = useAuth(),\n      user = _useAuth.user;\n\n  var navigation = useNavigation();\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      laudos = _useState2[0],\n      setLaudos = _useState2[1];\n\n  var dataKey = \"@laudos_user:\" + user.id;\n\n  var _useState3 = useState({}),\n      _useState4 = _slicedToArray(_useState3, 2),\n      report = _useState4[0],\n      setReport = _useState4[1];\n\n  var tokenStorageKey = \"@AppAuth:token\";\n\n  var _useState5 = useState(\"todos\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      filter = _useState6[0],\n      setFilter = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      visible = _useState8[0],\n      setVisible = _useState8[1];\n\n  var _useState9 = useState(AsyncStorage.getItem(\"@AppAuth:token\") || \"\"),\n      _useState10 = _slicedToArray(_useState9, 1),\n      storagedToken = _useState10[0];\n\n  var saveData = function saveData(laudos) {\n    return _regeneratorRuntime.async(function saveData$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(AsyncStorage.setItem(dataKey, JSON.stringify(laudos)));\n\n          case 3:\n            navigation.navigate(\"MyReports\");\n            _context.next = 9;\n            break;\n\n          case 6:\n            _context.prev = 6;\n            _context.t0 = _context[\"catch\"](0);\n            Alert.alert(\"Erro\", \"Não foi possível atualizar a lista de laudos\");\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[0, 6]], Promise);\n  };\n\n  var removeReport = function removeReport(value) {\n    for (var _iterator = _createForOfIteratorHelperLoose(laudos.entries()), _step; !(_step = _iterator()).done;) {\n      var _ref = _step.value;\n\n      var _ref2 = _slicedToArray(_ref, 2);\n\n      var index = _ref2[0];\n      var item = _ref2[1];\n\n      if (index == value) {\n        item.LaudoVeicular.statusDoLaudo.oculto = true;\n      }\n\n      setLaudos(laudos);\n    }\n\n    saveData(laudos);\n  };\n\n  var handleGoBack = function handleGoBack() {\n    navigation.navigate(\"VehicleSelect\");\n  };\n\n  var handleFilteredReportsSincronized = function handleFilteredReportsSincronized(status) {\n    var newArray = laudos.filter(function (item) {\n      return item.LaudoVeicular.statusDoLaudo.sincronizado === status;\n    });\n    return setLaudos(newArray);\n  };\n\n  var handleFilteredReportsIncomplet = function handleFilteredReportsIncomplet(status) {\n    var newArray = laudos.filter(function (item) {\n      return item.LaudoVeicular.statusDoLaudo.completo === status;\n    });\n    return setLaudos(newArray);\n  };\n\n  var handleRemove = function handleRemove(index) {\n    Alert.alert(\"Atenção\", \"Tem certeza que deseja remover?\", [{\n      text: \"Não 🙏\",\n      style: \"cancel\"\n    }, {\n      text: \"Sim 😥\",\n      onPress: function onPress() {\n        return _regeneratorRuntime.async(function onPress$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                try {\n                  removeReport(index);\n                } catch (error) {\n                  Alert.alert(\"Não foi possível remover!\");\n                }\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      }\n    }]);\n  };\n\n  var toSendReport = function toSendReport(report) {\n    var reporConvert, response;\n    return _regeneratorRuntime.async(function toSendReport$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            reporConvert = JSON.stringify(report);\n            console.log(reporConvert);\n            _context3.prev = 2;\n            _context3.next = 5;\n            return _regeneratorRuntime.awrap(api.post(\"/reports\", reporConvert, {\n              headers: {\n                \"Access-Control-Allow-Origin\": \"*\",\n                \"Content-type\": \"Application/json\"\n              }\n            }));\n\n          case 5:\n            response = _context3.sent;\n            report.LaudoVeicular.statusDoLaudo.sincronizado = true;\n            _context3.next = 9;\n            return _regeneratorRuntime.awrap(update(dataKey, report));\n\n          case 9:\n            _context3.next = 14;\n            break;\n\n          case 11:\n            _context3.prev = 11;\n            _context3.t0 = _context3[\"catch\"](2);\n            Alert.alert(\"Não foi possível enviar o laudo, verifique se os dados estão corretos!\");\n\n          case 14:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, null, null, [[2, 11]], Promise);\n  };\n\n  function loadLaudos() {\n    var response, storegedLaudos, arrayReportAvailable, _iterator2, _step2, item;\n\n    return _regeneratorRuntime.async(function loadLaudos$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            _context4.next = 2;\n            return _regeneratorRuntime.awrap(AsyncStorage.getItem(dataKey));\n\n          case 2:\n            response = _context4.sent;\n\n            if (!response) {\n              _context4.next = 9;\n              break;\n            }\n\n            storegedLaudos = response ? JSON.parse(response) : [];\n            arrayReportAvailable = [];\n\n            for (_iterator2 = _createForOfIteratorHelperLoose(storegedLaudos); !(_step2 = _iterator2()).done;) {\n              item = _step2.value;\n\n              if (item.LaudoVeicular.statusDoLaudo.oculto == false) {\n                arrayReportAvailable.push(item);\n              }\n            }\n\n            setLaudos(arrayReportAvailable);\n            return _context4.abrupt(\"return\", arrayReportAvailable);\n\n          case 9:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  }\n\n  useEffect(function () {\n    loadLaudos();\n  }, []);\n  useEffect(function () {\n    loadLaudos();\n  }, [laudos]);\n  return React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 7\n    }\n  }, React.createElement(Header, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 9\n    }\n  })), React.createElement(View, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 7\n    }\n  }, React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: styles.title,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 11\n    }\n  }, \" Laudos \")), React.createElement(View, {\n    style: styles.containerLegend,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 9\n    }\n  }, React.createElement(Text, {\n    style: styles.subtitle,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 11\n    }\n  }, \" Laudo \"), React.createElement(Text, {\n    style: styles.subtitleStatus,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 11\n    }\n  }, \" Status \")), laudos.length != 0 ? React.createElement(FlatList, {\n    data: laudos,\n    renderItem: function renderItem(_ref3) {\n      var LaudoVeicular = _ref3.item,\n          index = _ref3.index;\n      return React.createElement(Swipeable, {\n        key: index,\n        overshootRight: false,\n        renderRightActions: function renderRightActions() {\n          return React.createElement(Animated.View, {\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 179,\n              columnNumber: 19\n            }\n          }, React.createElement(View, {\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 180,\n              columnNumber: 21\n            }\n          }, React.createElement(RectButton, {\n            style: styles.buttonRemove,\n            onPress: function onPress() {\n              return handleRemove(index);\n            },\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 181,\n              columnNumber: 23\n            }\n          }, React.createElement(Feather, {\n            name: \"trash\",\n            size: 20,\n            color: colors.white,\n            __self: _this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 25\n            }\n          }))));\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 15\n        }\n      }, React.createElement(TouchableOpacity, {\n        onPress: function onPress() {\n          return toSendReport(LaudoVeicular);\n        },\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 17\n        }\n      }, React.createElement(ReportCard, {\n        data: LaudoVeicular,\n        setVisible: setVisible,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199,\n          columnNumber: 19\n        }\n      })));\n    },\n    keyExtractor: function keyExtractor(item) {\n      return item.LaudoVeicular.id;\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 11\n    }\n  }) : React.createElement(View, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 206,\n      columnNumber: 11\n    }\n  }, React.createElement(Text, {\n    style: styles.textResult,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 207,\n      columnNumber: 13\n    }\n  }, \" \", \"N\\xE3o h\\xE1 nenhum registro de laudos\"))), React.createElement(View, {\n    style: styles.footer,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 7\n    }\n  }, React.createElement(BackArrowButton, {\n    title: \"Voltar\",\n    icone: \"arrow-left\",\n    onPress: handleGoBack,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 9\n    }\n  })));\n}","map":{"version":3,"sources":["/home/amanda-kenzie/Documents/Faculdade/TCC/mobile/app-react-native-report/src/pages/MyReports/index.tsx"],"names":["React","useState","useEffect","useNavigation","RectButton","AsyncStorage","styles","Feather","Swipeable","ReportCard","Header","BackArrowButton","api","useAuth","colors","update","MyReports","user","navigation","laudos","setLaudos","dataKey","id","report","setReport","tokenStorageKey","filter","setFilter","visible","setVisible","getItem","storagedToken","saveData","setItem","JSON","stringify","navigate","Alert","alert","removeReport","value","entries","index","item","LaudoVeicular","statusDoLaudo","oculto","handleGoBack","handleFilteredReportsSincronized","status","newArray","sincronizado","handleFilteredReportsIncomplet","completo","handleRemove","text","style","onPress","error","toSendReport","reporConvert","console","log","post","headers","response","loadLaudos","storegedLaudos","parse","arrayReportAvailable","push","container","title","containerLegend","subtitle","subtitleStatus","length","buttonRemove","white","textResult","footer"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  Text,\n  View,\n  FlatList,\n  TouchableOpacity,\n  Alert,\n  Animated,\n} from \"react-native\";\nimport { useNavigation } from \"@react-navigation/core\";\nimport { RectButton } from \"react-native-gesture-handler\";\n\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\n\nimport styles from \"./styles\";\nimport { Feather } from \"@expo/vector-icons\";\nimport Swipeable from \"react-native-gesture-handler/Swipeable\";\n\nimport { ReportCard, ReportCardData } from \"../../components/ReportCard\";\nimport { Header } from \"../../components/Header\";\nimport { BackArrowButton } from \"../../components/Buttons/BackArrowButton\";\n\nimport { Select } from \"../../../src/components/Select\";\n\nimport { api } from \"../../services/api\";\nimport { useAuth } from \"../../hooks/auth\";\nimport colors from \"../../styles/colors\";\nimport { update } from \"../../services/database/storage\";\nimport { SelectString } from \"../../components/Select/SelectString\";\nimport { optionsStatusReports } from \"../../config/constants\";\n\nexport interface DataLitsProps extends ReportCardData {\n  id: string;\n}\n\nexport function MyReports() {\n  const { user } = useAuth();\n  const navigation = useNavigation();\n  const [laudos, setLaudos] = useState<DataLitsProps[]>([]);\n  const dataKey = `@laudos_user:${user.id}`;\n  const [report, setReport] = useState({});\n  const tokenStorageKey = \"@AppAuth:token\";\n  const [filter, setFilter] = useState(\"todos\");\n  const [visible, setVisible] = useState(true);\n\n  const [storagedToken] = useState(\n    AsyncStorage.getItem(\"@AppAuth:token\") || \"\"\n  );\n\n  const saveData = async (laudos: any) => {\n    try {\n      await AsyncStorage.setItem(dataKey, JSON.stringify(laudos));\n\n      navigation.navigate(\"MyReports\");\n    } catch (error) {\n      Alert.alert(\"Erro\", \"Não foi possível atualizar a lista de laudos\");\n    }\n  };\n\n  const removeReport = (value: number) => {\n    for (const [index, item] of laudos.entries()) {\n      if (index == value) {\n        item.LaudoVeicular.statusDoLaudo.oculto = true;\n      }\n      setLaudos(laudos);\n    }\n    saveData(laudos);\n  };\n\n  const handleGoBack = () => {\n    navigation.navigate(\"VehicleSelect\");\n  };\n\n  const handleFilteredReportsSincronized = (status: boolean) => {\n    const newArray = laudos.filter((item) => {\n      return item.LaudoVeicular.statusDoLaudo.sincronizado === status;\n    });\n    return setLaudos(newArray);\n  };\n\n  const handleFilteredReportsIncomplet = (status: boolean) => {\n    const newArray = laudos.filter((item) => {\n      return item.LaudoVeicular.statusDoLaudo.completo === status;\n    });\n    return setLaudos(newArray);\n  };\n\n  const handleRemove = (index: number) => {\n    Alert.alert(\"Atenção\", `Tem certeza que deseja remover?`, [\n      {\n        text: \"Não 🙏\",\n        style: \"cancel\",\n      },\n      {\n        text: \"Sim 😥\",\n        onPress: async () => {\n          try {\n            removeReport(index);\n          } catch (error) {\n            Alert.alert(\"Não foi possível remover!\");\n          }\n        },\n      },\n    ]);\n  };\n\n  const toSendReport = async (report: any) => {\n    const reporConvert = JSON.stringify(report);\n    console.log(reporConvert);\n    try {\n      const response = await api.post(\n        \"/reports\",\n\n        reporConvert,\n\n        {\n          headers: {\n            \"Access-Control-Allow-Origin\": \"*\",\n            \"Content-type\": \"Application/json\",\n          },\n        }\n      );\n      report.LaudoVeicular.statusDoLaudo.sincronizado = true;\n      await update(dataKey, report);\n    } catch (error) {\n      Alert.alert(\n        \"Não foi possível enviar o laudo, verifique se os dados estão corretos!\"\n      );\n    }\n  };\n\n  async function loadLaudos() {\n    const response = await AsyncStorage.getItem(dataKey);\n\n    if (response) {\n      const storegedLaudos: DataLitsProps[] = response\n        ? JSON.parse(response)\n        : [];\n\n      let arrayReportAvailable = [];\n      for (const item of storegedLaudos) {\n        if (item.LaudoVeicular.statusDoLaudo.oculto == false) {\n          arrayReportAvailable.push(item);\n        }\n      }\n\n      setLaudos(arrayReportAvailable);\n      return arrayReportAvailable;\n    }\n  }\n  useEffect(() => {\n    loadLaudos();\n  }, []);\n  useEffect(() => {\n    loadLaudos();\n  }, [laudos]);\n\n  return (\n    <View style={styles.container}>\n      <View>\n        <Header></Header>\n      </View>\n      <View style={styles.container}>\n        <View>\n          <Text style={styles.title}> Laudos </Text>\n        </View>\n        <View style={styles.containerLegend}>\n          <Text style={styles.subtitle}> Laudo </Text>\n          <Text style={styles.subtitleStatus}> Status </Text>\n        </View>\n        {laudos.length != 0 ? (\n          <FlatList\n            data={laudos}\n            renderItem={({ item: LaudoVeicular, index }) => (\n              <Swipeable\n                key={index}\n                overshootRight={false}\n                renderRightActions={() => (\n                  <Animated.View>\n                    <View>\n                      <RectButton\n                        style={styles.buttonRemove}\n                        onPress={() => handleRemove(index)}\n                      >\n                        <Feather\n                          name=\"trash\"\n                          size={20}\n                          color={colors.white}\n                        ></Feather>\n                      </RectButton>\n                    </View>\n                  </Animated.View>\n                )}\n              >\n                <TouchableOpacity\n                  onPress={() => toSendReport(LaudoVeicular)}\n               \n                >\n                  <ReportCard data={LaudoVeicular} setVisible={setVisible}/>\n                </TouchableOpacity>\n              </Swipeable>\n            )}\n            keyExtractor={(item) => item.LaudoVeicular.id}\n          />\n        ) : (\n          <View>\n            <Text style={styles.textResult}>\n              {\" \"}\n              Não há nenhum registro de laudos\n            </Text>\n          </View>\n        )}\n      </View>\n\n      <View style={styles.footer}>\n        <BackArrowButton\n          title=\"Voltar\"\n          icone=\"arrow-left\"\n          onPress={handleGoBack}\n        />\n      </View>\n    </View>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}